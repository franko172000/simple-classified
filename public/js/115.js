(self.webpackChunk=self.webpackChunk||[]).push([[115],{57115:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(87757),s=r.n(a),n=r(20629),i=r(10642),o=r(50703);function c(e,t,r,a,s,n,i){try{var o=e[n](i),c=o.value}catch(e){return void r(e)}o.done?t(c):Promise.resolve(c).then(a,s)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(a,s){var n=e.apply(t,r);function i(e){c(n,a,s,i,o,"next",e)}function o(e){c(n,a,s,i,o,"throw",e)}i(void 0)}))}}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d={data:function(){return{uploadProgress:!1,uploadImgProgress:!1,images:[],categories:[],locations:[],listing:{},currencies:[{name:"Naira",code:"NGN"},{name:"US Dollars",code:"USD"}],form:this.$form.createForm(this)}},computed:m(m({},(0,n.rn)(["tmpPhotos"])),{},{getLocations:function(){return this.locations},getCategories:function(){return this.categories},getImages:function(){return this.images},getListing:function(){return this.listing}}),methods:{checkFile:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||this.$notification.error({message:"You can only upload JPG & PNG file!"});var r=e.size/1024/1024<2;return r||this.$notification.error({message:"Image must smaller than 2MB!"}),t&&r},triggerClick:function(){this.$refs.filePic.click()},onSelectedPhoto:function(e){var t=this;return l(s().mark((function r(){var a,n,i,c;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=e.target.files[0],t.checkFile(a)){r.next=3;break}return r.abrupt("return",!1);case 3:return t.imgSrc=URL.createObjectURL(e.target.files[0]),(n=new FormData).append("photo",t.$refs.filePic.files[0]),t.uploadImgProgress=!0,r.next=9,(0,o.mJ)(n);case 9:i=r.sent,(c=i.data.data).removed=!1,c.new=!0,t.images.push(c),t.uploadImgProgress=!1;case 15:case"end":return r.stop()}}),r)})))()},removeImage:function(e,t){var r=this;this.$modal.confirm({title:"Delete image?",onOk:function(){return l(s().mark((function a(){return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.removed=!0,r.images.splice(e,1,t);case 2:case"end":return a.stop()}}),a)})))()}})},updatePost:function(){var e=this;return l(s().mark((function t(){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e,e.form.validateFields(function(){var t=l(s().mark((function t(a,n){var i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=8;break}if(0!==r.images.length){t.next=4;break}return r.$notification.error({message:"You must upload atleast one image"}),t.abrupt("return");case 4:r.uploadProgress=!0,n.images=r.images,i=e.$route.params.slug,(0,o.fc)(n,i).then((function(e){r.$notification.success({message:"Ad was updated successfully!"}),r.uploadProgress=!1,r.$store.dispatch("tmpPhotos/removeTempImages"),r.form.resetFields(),r.$router.push({name:"user-listings"})}));case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})))()},loadListing:function(){var e=this;return l(s().mark((function t(){var r,a,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$route.params.slug,t.next=3,(0,i.Ov)(r);case 3:a=t.sent,n=a.data.data,e.listing=n,e.listing.images.map((function(e){e.removed=!1})),e.images=e.listing.images,e.form.setFieldsValue({title:n.title,excerpt:n.excerpt,description:n.description,price:n.price,currency:n.currency,category:n.category_id,location:n.location_code});case 9:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return l(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadListing();case 2:(0,i.JC)().then((function(t){e.locations=t.data.data})),(0,i.tG)().then((function(t){e.categories=t.data.data}));case 4:case"end":return t.stop()}}),t)})))()}};const f=(0,r(51900).Z)(d,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("banner",{staticClass:"inner-banner",attrs:{showHomeButton:!0}},[r("h1",[e._v("Edit Listing")])]),e._v(" "),r("div",{staticClass:"h-100 w-full flex items-center justify-center bg-teal-lightest"},[r("div",{staticClass:"bg-white rounded shadow p-6 m-4 w-full lg:w-2/4 border-gray-300 border bottom-border-style"},[r("a-form",{attrs:{form:e.form},on:{submit:function(t){return t.preventDefault(),e.updatePost(t)}}},[r("div",[r("a-form-item",{attrs:{label:"Post title"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"Please enter post title"}]}],expression:"['title',{rules: [{ required: true, message: 'Please enter post title' }] }]"}],attrs:{placeholder:"Enter your post title",name:"title",size:"large"}})],1),e._v(" "),r("a-form-item",{attrs:{label:"Excerpt"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["excerpt",{rules:[{required:!0,message:"Please enter excerpt"}]}],expression:"['excerpt',{rules: [{ required: true, message: 'Please enter excerpt' }] }]"}],attrs:{rows:"5",type:"textarea"}})],1),e._v(" "),r("a-form-item",{attrs:{label:"Description"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!0,message:"Please enter description"}]}],expression:"['description',{rules: [{ required: true, message: 'Please enter description' }] }]"}],attrs:{rows:"10",type:"textarea"}})],1),e._v(" "),r("a-form-item",{attrs:{label:"Ad Photo"}},[r("a-button",{attrs:{htmlType:"button",loading:e.uploadImgProgress},on:{click:function(t){return t.preventDefault(),e.triggerClick(t)}}},[r("a-icon",{attrs:{type:"upload"}}),e._v("Click to select photo\n                          ")],1),e._v(" "),e._l(e.getImages,(function(t,a){return r("div",{directives:[{name:"show",rawName:"v-show",value:!t.removed,expression:"!img.removed"}],key:a,staticClass:"flex"},[r("div",{staticClass:"bg-white w-2/4 flex items-center p-2 rounded shadow border m-1"},[r("div",{staticClass:"flex items-center space-x-4"},[r("img",{staticClass:"w-16 h-16 rounded-xl",attrs:{src:t.photo,alt:"My profile"}})]),e._v(" "),r("div",{staticClass:"flex-grow p-3"},[r("div",{staticClass:"text-sm text-gray-500"},[e._v("\n                                    img.filename\n                                  ")])]),e._v(" "),r("div",{staticClass:"p-2"},[r("button",{attrs:{type:"button"},on:{click:function(r){return e.removeImage(a,t)}}},[r("i",{staticClass:"fas fa-trash"})])])])])}))],2),e._v(" "),r("div",{staticClass:"col-2-grid"},[r("a-form-item",{attrs:{label:"Price"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["price",{rules:[{required:!0,message:"Please enter price"}]}],expression:"['price',{rules: [{ required: true, message: 'Please enter price' }] }]"}],attrs:{placeholder:"Enter price",name:"price",size:"large"}})],1),e._v(" "),r("a-form-item",{attrs:{label:"Currency"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["currency",{rules:[{required:!0,message:"Please select currency"}]}],expression:"['currency',{rules: [{ required: true, message: 'Please select currency' }] }]"}],attrs:{size:"large"}},e._l(e.currencies,(function(t,a){return r("a-select-option",{key:a,attrs:{value:t.code}},[e._v("\n                                    "+e._s(t.name)+"\n                                ")])})),1)],1)],1),e._v(" "),r("div",{staticClass:"col-2-grid"},[r("a-form-item",{attrs:{label:"Category"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["category",{rules:[{required:!0,message:"Please select category"}]}],expression:"['category',{rules: [{ required: true, message: 'Please select category' }] }]"}],attrs:{size:"large"}},e._l(e.getCategories,(function(t,a){return r("a-select-option",{key:a,attrs:{value:t.id}},[e._v("\n                                    "+e._s(t.name)+"\n                                ")])})),1)],1),e._v(" "),r("a-form-item",{attrs:{label:"Location"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["location",{rules:[{required:!0,message:"Please select location"}]}],expression:"['location',{rules: [{ required: true, message: 'Please select location' }] }]"}],attrs:{size:"large"}},e._l(e.getLocations,(function(t,a){return r("a-select-option",{key:a,attrs:{value:t.code}},[e._v("\n                                    "+e._s(t.name)+"\n                                ")])})),1)],1)],1),e._v(" "),r("a-button",{staticClass:"text-center w-100",attrs:{type:"primary",size:"large",loading:e.uploadProgress,htmlType:"submit"}},[r("strong",[e._v("Submit")])])],1)]),e._v(" "),r("form",[r("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"filePic",attrs:{type:"file",name:"profile_photo"},on:{change:e.onSelectedPhoto}})])],1)])],1)}),[],!1,null,null,null).exports}}]);